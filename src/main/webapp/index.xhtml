<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <h:outputStylesheet library="css" name="spectre.min.css"/>
    <h:outputStylesheet library="css" name="spectre-exp.min.css"/>
    <h:outputStylesheet library="css" name="spectre-icons.min.css"/>
    <style type="text/css">
        .t1, .t2, .t3, .t4, .t5, .t6 {
            border: 1px solid gray;
            width: 30px;
            height: 30px;
            margin-right: 5px;
            display: inline-block;
        }

        .t2 {
            border-left: 4px solid gray;
        }

        .t3 {
            border-left: 4px solid gray;
            border-top: 4px solid gray;
        }

        .t4 {
            border-left: 4px solid gray;
            border-right: 4px solid gray;
        }

        .t5 {
            border: 4px solid gray;
            border-right: 1px solid gray;
        }

        .t6 {
            border: 4px solid gray;
        }
    </style>

</h:head>

<h:body>

    <h3>Dados da laje</h3>

    <h:form class="laje" prependId="false">

        <div class="container">
            <div class="columns">

                <div class="form-group column col-3 col-md-12">
                    <label class="form-label" for="lx">Lx</label>
                    <h:inputText id="lx" type="number" value="${calculoMBean.laje.lx}"/>
                </div>

                <div class="form-group column col-3 col-md-12">
                    <label class="form-label" for="ly">Ly</label>
                    <h:inputText id="ly" type="number" value="${calculoMBean.laje.ly}"/>
                </div>

                <div class="form-group column col-12">
                    <h:inputHidden id="contorno" value="#{calculoMBean.laje.contorno}" required="true"/>
                    <h:outputLabel class="form-label" value="Contorno"/>
                    <label class="form-radio form-inline">
                        <input type="radio" onselect="alteraContorno(this.value)" name="contorno" value="TYPE_1"
                               checked="checked"/>
                        <i class="form-icon"/>
                        <span class="t1"></span>
                    </label>
                    <label class="form-radio form-inline">
                        <input type="radio" onselect="alteraContorno(this.value)" name="contorno" value="TYPE_2"/>
                        <i class="form-icon"/>
                        <span class="t2"></span>
                    </label>
                    <label class="form-radio form-inline">
                        <input type="radio" onselect="alteraContorno(this.value)" name="contorno" value="TYPE_3"/>
                        <i class="form-icon"/>
                        <span class="t3"></span>
                    </label>
                    <label class="form-radio form-inline">
                        <input type="radio" onselect="alteraContorno(this.value)" name="contorno" value="TYPE_4"/>
                        <i class="form-icon"/>
                        <span class="t4"></span>
                    </label>
                    <label class="form-radio form-inline">
                        <input type="radio" onselect="alteraContorno(this.value)" name="contorno" value="TYPE_5"/>
                        <i class="form-icon"/>
                        <span class="t5"></span>
                    </label>
                    <label class="form-radio form-inline">
                        <input type="radio" onselect="alteraContorno(this.value)" name="contorno" value="TYPE_6"/>
                        <i class="form-icon"/>
                        <span class="t6"></span>
                    </label>
                </div>

                <div class="form-group column col-6 col-md-12">
                    <h:inputHidden id="caa" value="#{calculoMBean.laje.caa}" required="true"/>
                    <h:outputLabel class="form-label" for="caa" value="Classe de Agressividade (CAA)"/>
                    <label class="form-radio">
                        <input type="radio" onselect="alteraCAA(this.value)" name="caa" value="I"/>
                        <i class="form-icon"/>
                        I
                    </label>
                    <label class="form-radio">
                        <input type="radio" onselect="alteraCAA(this.value)" name="caa" value="II"
                               checked="checked"/>
                        <i class="form-icon"/>
                        II
                    </label>
                    <label class="form-radio">
                        <input type="radio" onselect="alteraCAA(this.value)" name="caa" value="III"/>
                        <i class="form-icon"/>
                        III
                    </label>
                    <label class="form-radio">
                        <input type="radio" onselect="alteraCAA(this.value)" name="caa" value="IV"/>
                        <i class="form-icon"/>
                        IV
                    </label>
                </div>

                <div class="form-group column col-6 col-md-12">
                    <h:inputHidden id="aco" value="#{calculoMBean.laje.aco}" required="true"/>
                    <h:outputLabel class="column col-2" for="aco" value="Aço"/>
                    <label class="form-radio">
                        <input type="radio" name="aco" value="CA25" onselect="alteraAco(this.value)"/>
                        <i class="form-icon"/>
                        CA25
                    </label>
                    <label class="form-radio">
                        <input type="radio" name="aco" value="CA50" onselect="alteraAco(this.value)"/>
                        <i class="form-icon"/>
                        CA50
                    </label>
                    <label class="form-radio">
                        <input type="radio" name="aco" value="CA60" onselect="alteraAco(this.value)"/>
                        <i class="form-icon"/>
                        CA60
                    </label>
                </div>

                <div class="form-group column col-3 col-md-12">
                    <h:outputLabel class="form-label" for="h" value="Altura (cm)"/>
                    <h:inputText id="h" type="number" value="#{calculoMBean.laje.altura}"/>
                </div>

                <div class="form-group column col-3 col-md-12">
                    <h:outputLabel class="form-label" for="fck" value="Fck"/>
                    <h:inputText id="fck" type="number" value="#{calculoMBean.laje.fck}"/>
                </div>

                <!--<div class="form-group column col-3 col-md-12">-->
                    <!--<h:outputLabel class="form-label" for="e" value="Espessura concreto (mm)"/>-->
                    <!--<h:inputText id="e" type="number" value="#{calculoMBean.laje.e}"/>-->
                <!--</div>-->

                <div class="form-group column col-3 col-md-12">
                    <h:outputLabel class="form-label" for="earg" value="Esp. cam de regularização (mm)"/>
                    <h:inputText id="earg" type="number" value="#{calculoMBean.laje.earg}"/>
                </div>

                <div class="form-group column col-3 col-md-12">
                    <h:outputLabel class="form-label" for="emat" value="Espessura do piso (mm)"/>
                    <h:inputText id="emat" type="number" value="#{calculoMBean.laje.emat}"/>
                </div>

                <div class="form-group column col-3 col-md-12">
                    <h:outputLabel class="form-label" for="q" value="q - Carga acidental (kN/m^2)"/>
                    <h:inputText id="q" value="#{calculoMBean.laje.q}" placeholder="0.00"/>
                </div>

                <h4 class="column col-12">Pesos especificos</h4>

                <div class="form-group column col-3 col-md-12">
                    <label class="form-label" for="concretoArmado">Concreto armado (kN/m<sup>2</sup>)</label>
                    <h:inputText id="concretoArmado" value="#{calculoMBean.laje.GConcreto}"/>
                </div>

                <div class="form-group column col-3 col-md-12">
                    <label class="form-label" for="argamassa">Camada de regularização (kN/m<sup>2</sup>)</label>
                    <h:inputText id="argamassa" name="argamassa" value="#{calculoMBean.laje.GArg}"/>
                </div>

                <div class="form-group column col-3 col-md-12">
                    <label class="form-label" for="material">Piso (kN/m<sup>2</sup>)</label>
                    <h:inputText id="material" name="material" value="#{calculoMBean.laje.GMat}"/>
                </div>

                <span class="column col-mx-auto"/>

                <h:commandButton id="calculate" styleClass="column col-3 btn" action="${calculoMBean.calcular}" value="Calcular">
                    <f:ajax execute="@form" render="result"/>
                </h:commandButton>

            </div>
        </div>

        <h:inputHidden id="result" value="#{calculoMBean.resultado}"/>

        <canvas id="canvas" width="400" height="200"></canvas>

    </h:form>

    <script type="application/javascript">
        //<![CDATA[
        (function () {
            var contorno = document.getElementById("contorno").value;
            var caa = document.getElementById("caa").value;
            var aco = document.getElementById("aco").value;

            var element = document.querySelector("[type=radio][value=" + contorno + "]");
            if (element)
                element.click();

            element = document.querySelector("[type=radio][value=" + caa + "]");
            if (element)
                element.click();

            element = document.querySelector("[type=radio][value=" + aco + "]");
            if (element)
                element.click();

            jsf.ajax.addOnEvent(function(event) {

               try {
                   if (event.status === 'success' && event.source.id === 'calculate') {
                       var resultJSON = JSON.parse(document.getElementById("result").value);
                       desenhaRepresantacao(resultJSON.n1, resultJSON.n2);
                   }
               } catch (exception) {
                   console.err(exception);
                   desenhaRepresantacao(0, 0);
               }
            });

        })();

        function alteraContorno(value) {
            document.getElementById("contorno").value = value;
        }

        function alteraCAA(value) {
            document.getElementById("caa").value = value;
        }

        function alteraAco(value) {
            document.getElementById("aco").value = value;
        }

        function desenhaRepresantacao(n1, n2) {
            console.log('Representacao para laje...');
            console.log('n1: ' + n1);
            console.log('n2: ' + n2);

            var canvas = document.getElementById("canvas");
            var ctx = canvas.getContext("2d");
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            ctx.strokeRect(40, 40, 100, 120);

            ctx.beginPath();
            // n1
            ctx.moveTo(105, 40);
            ctx.lineTo(105, 160);
            // n2
            ctx.moveTo(40, 120);
            ctx.lineTo(140, 120);
            ctx.closePath();
            ctx.stroke();

            ctx.font = '10pt sans-serif';
            ctx.fillText(n1, 105, 30);
            ctx.fillText(n2, 150, 120);
        }
        //]]>
    </script>
</h:body>

</html>
